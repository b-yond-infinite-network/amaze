# Challenge 4 - Mysteries of the Cats

### Solution

Having never worked with any of this, I decided to start as simple as possible, and build improvements if time allowed. Unfortunately, the result is still quite minimal, as I spent most time learning things about the environment of Scala development, as well as _(wasted time on)_ my new nemesis Spark.

I separated the solution in two:

- `example.GeneratingApp`: An app that generates cats' mood swings and dumps it in a file, using akka streams.
- `example.AnalyticsApp`: An analytics app that uses spark to read the file and output basic counts.

üë∑üèº‚Äç‚ôÇÔ∏è See the How to run section to test it.


### Review & Improvements

By lack of time and lack of knowing better, there are a few things I would have liked to change before handing this over.

1. `GeneratingApp.scala` ln 40 and below. Learning more about **lifting** a type to another would allow me to return the Future of ln 46, and move the unholy sideeffect of ln 48 out. And generally handle the app lifetime better than this.

2. `AnalyticsApp.scala`, I tried to fiddle with Spark here for educational purposes. I don't like how I have to turn off all Spark logging because of my choice to use the console for user interaction. i.e. if it were a restful service I wouldn't care about spark's logging. 

 Also, I wasn't able to find how to unit test this spark app from a test file. I only tested the output formatting.

3. After doing the second service, analytics side, I realized it would've been preferable to parse arguments instead of prompting for user inputs in the first service.

The ideal architecture, had I had more time, would be:

- A generating service streaming values to Kafka, 
- A spark service reading from a kafka stream and updating stats aggregates in a database,
- A restful endpoint to read from the database at discrete times.
- All of the above being their individiual containers, managed with docker-compose

### Learnings


## How to run

**Generator**

As I've learned along the way, **you need Java 1.8** for (that version of) Spark to work properly.

In directory `moodycats/`, run:

`sbt runMain example.GeneratingApp`

The previous command does not take args. Rather, it prompts for inputs during execution.

**Stats**

Take the path generated by the GeneratingApp and pass it as an arg here:

`sbt runMain example.AnalyticsApp some/path/to/swings.txt`

The app will spit out the total moods, and a sorted count of every known mood.
